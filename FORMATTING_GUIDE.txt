================================================================================
PORTFOLIO FORMATTING GUIDE
Professional Excel Sheet Formatting & Enhancement
================================================================================

OVERVIEW
--------
This guide explains how to apply professional formatting to your portfolio
Excel files using the apply_formatting.py script.

QUICK START
-----------
1. Place your portfolio Excel file(s) in the same folder as format_all.py
2. Open PowerShell and run:
   
   For single file:
   python format_all.py "YourFileName.xlsx"
   
   For multiple files:
   python format_all.py "File1.xlsx" "File2.xlsx" "File3.xlsx"
   
   For all .xlsx files in folder:
   python format_all.py *.xlsx

3. Done! Your files are formatted professionally with auto-detection.


SUPPORTED FILE STRUCTURES
-------------------------
The universal formatter (format_all.py) automatically detects and formats:

TYPE A: Executive Summary + Monthly Performance Structure
• Sheet 1: Executive Summary (with KPIs, Trading Activity, Insights, etc.)
• Sheet 2: Monthly Performance (with monthly metrics and summaries)
• Sheet 3: Data Source (optional reference data)
• Example: Portfolio Report - Traditional IRA Enhanced.xlsx
• Formatting: Multi-sheet professional styling with distinct sections

TYPE B: Data Sheet Structure  
• Single Data sheet with monthly columns and metric rows
• Months as column headers (Mar 25, Apr 25, etc.)
• Metrics as row labels (Portfolio value, Total profit, etc.)
• Example: Portfolio report_Investment_07.02.2026.xlsx
• Formatting: Color-coded sections by metric category (Profit, Trading, Cash, Market)

WHAT GETS FORMATTED
-------------------

EXECUTIVE SUMMARY SHEET (Type A only):
• Professional dark blue title header (16pt bold white text)
• Medium blue section headers with white text
• Light blue metric labels with proper cell borders
• Styled column headers centered and aligned
• Optimized column widths for readability
• Professional data formatting with borders throughout

MONTHLY PERFORMANCE SHEET (Type A only):
• Large title header matching Executive Summary style
• Color-coded sections by category:
  - Yellow background: Profit Metrics
  - Green background: Trading Activity
  - Orange background: Cash Position
  - Light Red background: Market Comparison
• Professional borders on all data cells
• Right-aligned numeric values
• Optimized column widths for 12+ months of data

DATA SHEET (Type B only):
• Professional styled headers with all months displayed prominently
• Auto-detecting metric categories with color-coding:
  - Yellow: Profit-related metrics (Total profit, Dividends, Price gains, Sales)
  - Green: Trading-related metrics (Total trades, Buy/Sell trades, Turnover)
  - Orange: Cash-related metrics (Available cash, Deposits, Withdrawals)
  - Light Red: Market comparison
• Professional borders on all cells
• Right-aligned numeric values
• Optimized column widths (28 chars for metrics, 14 for months)


COLOR SCHEME
-----------
The formatting uses professional business colors:
• Dark Blue (#1F4788) - Main headers and titles
• Medium Blue (#4472C4) - Section headers
• Light Blue (#D9E1F2) - Metric labels
• Light Gray (#E7E6E6) - Highlight areas
• Yellow (#FFF2CC) - Profit metrics
• Green (#E2EFDA) - Trading activity
• Orange (#F4B084) - Cash position
• Light Red (#F1DCDB) - Market comparison
• White (#FFFFFF) - Data cells


COLUMN WIDTHS
-------------
After formatting, columns are optimized:
• Column A: 25-28 characters (metric names)
• Columns B-M: 14-18 characters (data columns)
This ensures readability without excessive scrolling.


REQUIREMENTS
-----------
• Python 3.7 or higher
• openpyxl library (for Excel manipulation)
• pandas (optional, for analysis)

To install required packages:
pip install openpyxl pandas


USING THE SCRIPT
----------------

METHOD 1: Single File
---------------------
python format_all.py "Portfolio1.xlsx"

METHOD 2: Multiple Files (Single Command)
-------------------------------------------
python format_all.py "Portfolio1.xlsx" "Portfolio2.xlsx" "Portfolio3.xlsx"

METHOD 3: All Files with Wildcard
-----------------------------------
python format_all.py *.xlsx

This will automatically format all .xlsx files in the current folder.

METHOD 4: Batch Processing with Batch File
--------------------------------------------
Create a file called "format_all.bat" with:
  python format_all.py Portfolio1.xlsx Portfolio2.xlsx Portfolio3.xlsx
  
Then run: format_all.bat

WHAT THE FORMATTER DOES AUTOMATICALLY
--------------------------------------
1. Detects file structure (Type A or Type B)
2. Applies appropriate formatting for that structure
3. Maintains consistent color scheme across all files
4. Optimizes column widths for readability
5. Adds professional borders and alignment
6. Color-codes data sections for quick scanning
7. Saves the formatted file automatically

EXAMPLE OUTPUT
--------------
Processing 4 file(s)...

Processing: Portfolio Report - Traditional IRA Enhanced.xlsx
  → Detected: Type A (Executive Summary + Monthly Performance structure)
  ✓ Executive Summary formatted
  ✓ Monthly Performance formatted
✓ File saved successfully!

Processing: Portfolio report_Investment_07.02.2026.xlsx
  → Detected: Type B (Data sheet structure)
  ✓ Data sheet formatted with professional styling
✓ File saved successfully!

COMPLETE: 4 file(s) formatted successfully


FILE REQUIREMENTS
-----------------
The formatter works with both common portfolio file structures:

TYPE A FILES require:
1. A sheet named "Executive Summary" with:
   - Title in cell A1
   - Date in cell A2
   - Section headers and data structured by rows
   - At least columns A-E for KPIs and trading activity

2. A sheet named "Monthly Performance" with:
   - Title in cell A1
   - Month headers in row 3
   - Metric data in rows below

TYPE B FILES require:
1. A sheet named "Data" with:
   - Title in first row (typically A1)
   - Month headers in a row (typically row 4, format: "Mar 25", "Apr 25", etc.)
   - Metric labels in column A
   - Data values in columns B+

Both structures are automatically detected and formatted correctly.
No adjustment needed - the formatter handles both!

If your files have significantly different structures, contact support 
or modify the format_all.py file.


BEFORE AND AFTER
----------------

BEFORE: Plain text, no formatting, hard to read
• No color differentiation
• Inconsistent fonts and sizes
• No borders or spacing
• Difficult to identify sections

AFTER: Professional business report
✓ Color-coded sections for quick navigation
✓ Clear hierarchy with styled headers
✓ Professional borders and alignment
✓ Easy to scan and understand
✓ Presentation-ready for stakeholders


TROUBLESHOOTING
---------------

ERROR: "python not found"
SOLUTION: Use full path: C:\Users\aladi\Excel_Portfolio_Formating\.venv\Scripts\python.exe apply_formatting.py "file.xlsx"

ERROR: "File not found"
SOLUTION: Make sure the .xlsx file is in the same folder as apply_formatting.py

ERROR: "openpyxl not installed"
SOLUTION: Run: pip install openpyxl

ERROR: "Permission denied"
SOLUTION: Close the file in Excel first, then run the script


CUSTOMIZATION OPTIONS
---------------------
For most users, no customization is needed. The formatter auto-detects 
your file structure and applies appropriate formatting.

To customize colors, fonts, or borders, edit format_all.py:

1. Colors - Change hex values in "Define color scheme" section
   Example: header_fill = PatternFill(start_color="NEW_COLOR_CODE", ...)

2. Font sizes - Change size=12 in font definitions  
   Example: header_font = Font(bold=True, size=14, color="FFFFFF")

3. Column widths - Modify in relevant format_type_a/b functions
   Example: ws_exec.column_dimensions['A'].width = 30

4. Section colors - Modify section_fills dictionary in format_type_b()
   Example: 'profit': PatternFill(start_color="NEW_COLOR", ...)

RECOMMENDED: Make a backup of format_all.py before editing.


ADDITIONAL ENHANCEMENTS (OPTIONAL)
----------------------------------
The following enhancements can be added separately if desired:

1. KEY INSIGHTS & RECOMMENDATIONS
   - Automatically analyzes and suggests portfolio insights
   - Highlights performance achievements
   - Identifies areas for improvement

2. ACTION ITEMS & STRATEGY
   - Provides specific recommendations
   - Links to portfolio metrics
   - Guides strategic decisions

3. 12-MONTH SUMMARY
   - Totals for profit, dividends, and gains
   - Key metrics at a glance
   - Comparison statistics

To apply these, contact support or request the enhancement script.


BEST PRACTICES
--------------
1. Always keep a backup of your original file before formatting
2. Close Excel before running the script
3. Run script from a folder with write permissions
4. Test on one file first before batch processing
5. Review the formatted file in Excel to ensure quality

TIPS FOR BEST RESULTS
-----------
1. Ensure all data is properly entered before formatting
2. Use consistent formatting in source data (dates, currency)
3. Keep metric names short and descriptive
4. Don't manually edit after formatting - reformat if changes needed
5. Print in landscape orientation for best presentation


PERFORMANCE NOTES
-----------------
• Script takes 1-2 seconds per file
• Works with files up to 10,000+ rows
• No data loss - only formatting applied
• Creating backups is still recommended


VERSION HISTORY
---------------
v2.0 (Feb 2026) - Universal Formatter Release
• Auto-detects Type A (Executive Summary + Monthly Performance) structure
• Auto-detects Type B (Data sheet) structure
• Single script handles both file types
• Works with multiple files in one command
• Intelligent section color-coding
• Batch processing support with wildcards

v1.0 (Feb 2026) - Initial release
• Professional color scheme
• Executive Summary formatting
• Monthly Performance formatting
• Optimized column widths
• Professional borders and alignment


SUPPORT / QUESTIONS
-------------------
If you need to:
• Customize colors or fonts
• Add more sections
• Format different sheet structures
• Batch process files

Edit this file and the apply_formatting.py script, or contact your administrator.


================================================================================
END OF DOCUMENTATION
================================================================================
